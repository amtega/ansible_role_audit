---
# Role tasks

- name: Install required packages
  include_tasks: install_rhel_centos.yml
  when: ansible_distribution == "CentOS" or ansible_distribution == "RHEL"

- name: configuring audit service
  template:
    src: audit_config.j2
    dest: "{{ audit_conf_file }}"

- debug:
    var: audit_template_file

- name: configuring audit rules from template file
  template:
    src: "{{ audit_template_file }}"
    dest: "{{ audit_rules_file }}"
  when: audit_template_file is defined and audit_template_file is not none
  notify: restart auditd



# - name: "insert audit rules in {{ audit_rules_file }}"
#   lineinfile:
#     path: "{{ audit_rules_file }}"
#     line: "{{ item }}"
#   with_items: "{{ audit_rules_raw_list }}"
#   notify: start auditd

- name: restart audit service
  meta: flush_handlers

#- name: start audit daemon
#- notify: restart auditd
